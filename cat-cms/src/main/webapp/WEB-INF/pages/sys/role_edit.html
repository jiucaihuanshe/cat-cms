<!-- Horizontal Form -->
<div class="box box-info">
	<div class="box-header with-border">
		<h3 class="box-title">Horizontal Form</h3>
	</div>
	<!-- /.box-header -->
	<!-- form start -->
	<form class="form-horizontal">
		<div class="box-body">
			<div class="form-group">
				<label for="inputEmail3" class="col-sm-2 control-label">角色名称</label>

				<div class="col-sm-10">
					<input type="text" class="form-control" id="nameId"
						placeholder="角色名称">
				</div>
			</div>
			<div class="form-group">
				<label for="inputPassword3" class="col-sm-2 control-label">角色描述</label>

				<div class="col-sm-10">
					<input type="text" class="form-control" id="noteId"
						placeholder="角色描述">
				</div>
			</div>
		</div>
		<!-- /.box-body -->
		<div class="box-footer">
			<button type="button" class="btn btn-default btn-cancel">Cancel</button>
			<button type="button" class="btn btn-info pull-right btn-save">Save</button>
		</div>
		<!-- /.box-footer -->
	</form>
</div>
<script type="text/javascript">
	$(function(){
		$(".box-footer").on("click",".btn-cancel",doCancel);
		$(".box-footer").on("click",".btn-save",doSaveOrUpdate);
		var id = $(".container-fluid").data("id");
		if(id){
			doFindObjectById(id);
		}
	});
	function doFindObjectById(id){
		var url = "role/doFindObjectById.do";
		var params = {"id":id};
		$.getJSON(url,params,function(result){
			if(result.state==1){
				doInitEditForm(result.data);
			}else{
				alert(result.message);
			}
		});
	}
	function doInitEditForm(result){
		$("#nameId").val(result.name);
		$("#noteId").val(result.note);
	}
	function doCancel(){
		$(".container-fluid").load("role/listUI.do");
		$(".container-fluid").removeData("id");
	}
	function doSaveOrUpdate(){
		//1.获取表单数据
		var params = getFormData();
		//2.异步提交
		//获取当前页面绑定的id值
		var id = $(".container-fluid").data("id");
		//假如id有值说明是修改,此时在参数中添加id值(k/v)
		if(id)params.id=id;
		//根据id值设置要执行的url
		var insertUrl = "role/doInsertObject.do";
		var updateUrl = "role/doUpdateObject.do";
		var url=id?updateUrl:insertUrl;
		$.post(url,params,function(result){
			if(result.state==1){
				alert(result.message);
				doCancel();
			}else{
				alert(result.message);
			}
		});
	}
	function getFormData(){
		var params = {
				"name":$("#nameId").val(),
				"note":$("#noteId").val()
		};
		return params;
	}
</script>